class ModalManager{constructor(e={}){this.options={closeOnEscape:!0,closeOnOutsideClick:!0,modalSelector:".modal-wrapper",modalTriggerAttribute:"data-modal",closeButtonSelector:".modal-close",baseZIndex:1e3,...e},this.openModals=[],this.lastFocusedElement=null,this.handleClick=this.handleClick.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.init()}init(){document.addEventListener("click",this.handleClick),this.options.closeOnEscape&&document.addEventListener("keydown",this.handleKeyDown)}handleClick(e){const{target:t}=e;if(t.hasAttribute(this.options.modalTriggerAttribute)||t.closest(`[${this.options.modalTriggerAttribute}]`)){e.preventDefault();const s=(t.hasAttribute(this.options.modalTriggerAttribute)?t:t.closest(`[${this.options.modalTriggerAttribute}]`)).getAttribute(this.options.modalTriggerAttribute);this.open(s)}if(t.matches(this.options.closeButtonSelector)||t.closest(this.options.closeButtonSelector)){e.preventDefault();const s=t.closest(this.options.modalSelector);s&&this.close(s.id)}if(this.options.closeOnOutsideClick&&t.matches(this.options.modalSelector)&&t===e.currentTarget){const e=t.id;e&&this.isOpen(e)&&this.close(e)}}handleKeyDown(e){if("Escape"===e.key&&this.openModals.length>0){e.preventDefault();const t=this.openModals[this.openModals.length-1];this.close(t)}"Tab"===e.key&&this.openModals.length>0&&this.handleTabKey(e)}handleTabKey(e){if(0===this.openModals.length)return;const t=this.openModals[this.openModals.length-1],s=document.getElementById(t);if(!s)return;const o=this.getFocusableElements(s);if(0===o.length)return;const n=o[0],l=o[o.length-1];e.shiftKey&&document.activeElement===n?(e.preventDefault(),l.focus()):e.shiftKey||document.activeElement!==l||(e.preventDefault(),n.focus())}getFocusableElements(e){return Array.from(e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')).filter((e=>!e.hasAttribute("disabled")&&"none"!==e.style.display))}open(e){const t=document.getElementById(e);if(!t||this.isOpen(e))return;this.lastFocusedElement=document.activeElement,this.openModals.push(e),t.style.zIndex=this.options.baseZIndex+this.openModals.length,t.style.display="block",t.setAttribute("aria-hidden","false"),document.body.classList.add("modal-open");const s=this.getFocusableElements(t);s.length>0&&setTimeout((()=>{s[0].focus()}),100),t.dispatchEvent(new CustomEvent("modal:open",{bubbles:!0,detail:{modalId:e}}))}close(e){const t=document.getElementById(e);if(!t||!this.isOpen(e))return;const s=this.openModals.indexOf(e);if(-1!==s&&this.openModals.splice(s,1),t.style.display="none",t.setAttribute("aria-hidden","true"),0===this.openModals.length&&document.body.classList.remove("modal-open"),0===this.openModals.length&&this.lastFocusedElement)this.lastFocusedElement.focus(),this.lastFocusedElement=null;else if(this.openModals.length>0){const e=this.openModals[this.openModals.length-1],t=document.getElementById(e);if(t){const e=this.getFocusableElements(t);e.length>0&&e[0].focus()}}t.dispatchEvent(new CustomEvent("modal:close",{bubbles:!0,detail:{modalId:e}}))}closeAll(){[...this.openModals].forEach((e=>this.close(e)))}isOpen(e){return this.openModals.includes(e)}getOpenModals(){return[...this.openModals]}getActiveModal(){return 0===this.openModals.length?null:this.openModals[this.openModals.length-1]}destroy(){document.removeEventListener("click",this.handleClick),document.removeEventListener("keydown",this.handleKeyDown),this.closeAll(),this.openModals=[]}}!function(){function e(){window.modalManager=new ModalManager}"undefined"!=typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e())}();